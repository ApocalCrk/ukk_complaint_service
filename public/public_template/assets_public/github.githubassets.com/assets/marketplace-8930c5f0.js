System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(e,t){"use strict";var n,r,a,s,o,c,l;return{setters:[function(e){n=e.o,r=e.r,a=e.a},function(e){s=e.t,o=e.r,c=e.aw,l=e.a}],execute:function(){function e(e){e.closest(".js-marketplace-listing-form-container").querySelector(".js-marketplace-listing-error-container").hidden=!0}function i(e,t){const n=e.closest(".js-marketplace-listing-form-container").querySelector(".js-marketplace-listing-error-container");n.hidden=!1;n.querySelector(".js-marketplace-listing-error").textContent=t}function d(e){const t=e.querySelector(".js-marketplace-listing-save-notice");t&&(t.classList.add("visible"),setTimeout((()=>t.classList.remove("visible")),1500))}function u(e,t){const n=e.closest(".js-marketplace-listing-form-container").querySelectorAll(".js-marketplace-listing-bgcolor");for(const r of n)r instanceof HTMLElement&&(r.style.backgroundColor="#"+t)}function p(e){const t=document.querySelector(".js-hero-listing-container .js-hero-listing-bgcolor");t instanceof HTMLElement&&(t.style.backgroundColor="#"+e)}function m(e,t,n){const r=n.closest(".js-listing-characters-remaining-container").querySelector(".js-listing-characters-remaining"),a=String(r.getAttribute("data-suffix")),s=t-c(e);r.textContent=`${s} ${a}`,r.classList.toggle("text-red",s<=5)}function g(e){const t=e.item,n=t.querySelector(".js-marketplace-listing-screenshot-resequence-form"),r=n.elements.namedItem("marketplace_listing_screenshot[previousScreenshotId]"),a=t.previousElementSibling;a instanceof HTMLElement?r.value=a.getAttribute("data-screenshot-id"):r.value="",o(n)}function f(e){return["FLAT_RATE","PER_UNIT"].includes(e)}function j(e){return"PER_UNIT"===e}function k(e,t){for(const n of e)n.disabled=!t}async function y(e){const t=e.target,n=parseInt(t.value,10).toFixed(),r=t.getAttribute("data-url"),a=new URL(r,window.location.origin),s=new URLSearchParams(a.search.slice(1));s.set("quantity",n),a.search=s.toString();const o=await l(document,a.toString()),c=document.querySelector(".js-marketplace-order-preview");c.innerHTML="",c.appendChild(o)}s(".js-marketplace-short-description-field",(function(e){const t=e.target,n=t.closest(".form-group");t.validity.patternMismatch?n.classList.add("errored"):n.classList.remove("errored")})),n("click",".js-marketplace-error-dismiss",(function(t){e(t.currentTarget)})),n("change",".js-marketplace-listing-light-text",(function(e){!function(e){const t=document.querySelector(".js-hero-listing-name");t&&("true"===e?(t.classList.add("text-white"),t.classList.remove("text-gray-dark")):(t.classList.remove("text-white"),t.classList.add("text-gray-dark")))}(e.target.value)})),n("change",".js-marketplace-listing-logo-background-color",(function(e){const t=e.target;u(t.closest("form"),t.value),p(t.value)})),r(".js-marketplace-listing-form",(async function(t,n){let r;e(t);try{r=await n.json()}catch(a){if(!a.response)throw a;return void i(t,a.response.json.error)}if(r.json.path){const e=window.location.pathname,t=r.json.path;if(e!==t)return void(window.location.href=t)}r.json.bgcolor&&(u(t,r.json.bgcolor),p(r.json.bgcolor)),r.json.short_description&&function(e){const t=document.querySelector(".js-hero-listing-description");t&&(t.textContent=e)}(r.json.short_description),d(t)})),r(".js-marketplace-listing-screenshot-update-form",(async function(e,t){try{await t.text()}catch(s){return void function(e){const t=e.querySelector(".js-marketplace-listing-save-error");t&&(t.classList.add("visible"),setTimeout((()=>t.classList.remove("visible")),1500))}(e)}const n=e.querySelector(".js-marketplace-listing-screenshot-caption-field"),r=e.querySelector(".js-marketplace-listing-screenshot-caption-present"),a=e.querySelector(".js-marketplace-listing-screenshot-caption-empty");r.textContent=n.value,n.value.trim().length<1?(r.classList.add("d-none"),a.classList.remove("d-none")):(r.classList.remove("d-none"),a.classList.add("d-none")),d(e)})),r(".js-marketplace-listing-screenshot-delete-form",(async function(t,n){e(t);const r=t.querySelector(".js-marketplace-listing-screenshot-delete-button");r.disabled=!0;try{await n.text()}catch(a){if(a.response){try{i(t,a.response.json.error)}catch(s){throw a}finally{r.disabled=!1}return}throw a}t.closest(".js-marketplace-listing-screenshot-container").remove()})),s("textarea.js-listing-characters-remaining-field",(function(e){const t=e.target,n=parseInt(t.getAttribute("data-character-limit")||"",10);m(t.value,n,t)})),s("input.js-listing-characters-remaining-field",(function(e){const t=e.target,n=t.maxLength;m(t.value,n,t)})),n("details-menu-selected",".js-languages-menu",(function(e){const t=e.currentTarget.querySelectorAll('[role="menuitemcheckbox"][aria-checked="true"]');document.querySelector(".js-language-selection").textContent=Array.from(t).map((e=>(e.textContent||"").trim())).sort().join(", ")}),{capture:!0}),a(".js-draggable-screenshots-container",{async add(e){const{Sortable:n}=await t.import("./chunk-sortable-behavior.js");n.create(e,{animation:150,draggable:".js-draggable-screenshot",onUpdate:g})}}),a(".js-listing-plan-option:checked",{constructor:HTMLInputElement,add(e){const t=e.value,n=e.closest(".js-marketplace-edit-plan-editor"),r=n.querySelectorAll(".js-marketplace-plan-price-field-group"),a=n.querySelectorAll(".js-marketplace-plan-free-trial-field-group"),s=n.querySelectorAll(".js-marketplace-plan-unit-field-group");!function(e){for(const t of document.querySelectorAll(".js-marketplace-plan-edit-unit"))t instanceof HTMLElement&&(t.hidden=!j(e));for(const t of document.querySelectorAll(".js-marketplace-plan-edit-price, .js-marketplace-plan-enable-free-trial"))t instanceof HTMLElement&&(t.hidden=!f(e))}(t),k(r,["FLAT_RATE","PER_UNIT"].includes(t)),k(a,f(t)),k(s,j(t)),n.querySelector(".js-marketplace-plan-unit-name-field").required=j(t)}}),n("click",".js-marketplace-plan-preview-toggle",(function(e){const t=e.currentTarget.closest(".js-marketplace-edit-plan-container"),n=t.querySelector(".js-marketplace-plan-editor-toggle"),r=t.querySelector(".js-marketplace-edit-plan-editor"),a=t.querySelector(".js-marketplace-edit-plan-preview");a.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),a.classList.remove("d-none"),r.classList.add("d-none"),function(e,t){const n=t.querySelector(".js-marketplace-plan-name"),r=e.querySelector(".js-marketplace-plan-name-field").value;n.textContent=r;const a=t.querySelector(".js-marketplace-free-trial-container"),s=t.querySelector(".js-marketplace-no-trial-container"),o=t.querySelector(".js-marketplace-direct-billing-container");e.querySelector(".js-marketplace-free-trial-field").checked?(a.classList.remove("d-none"),o.classList.add("d-none"),s.classList.add("d-none")):(s.classList.remove("d-none"),a.classList.add("d-none"),o.classList.add("d-none"));const c=e.querySelector(".js-listing-plan-option:checked").value,l=t.querySelectorAll(".js-marketplace-plan-unit-name"),i=t.querySelector(".js-marketplace-plan-per-unit-info");if("PER_UNIT"===c){const t=e.querySelector(".js-marketplace-plan-unit-name-field").value;for(const e of l)e.textContent=t,e.classList.remove("d-none");i.classList.remove("d-none")}else{for(const e of l)e.classList.add("d-none");i.classList.add("d-none")}if("FREE"===c||"DIRECT_BILLING"===c){const e=t.querySelectorAll(".js-marketplace-plan-dollars-container");for(const t of e)t.classList.add("d-none")}else{const n=t.querySelector(".js-marketplace-plan-monthly-dollars"),r=e.querySelector(".js-marketplace-plan-monthly-price-field").value;n.textContent=r,n.closest(".js-marketplace-plan-dollars-container").classList.remove("d-none");const a=t.querySelector(".js-marketplace-plan-yearly-dollars"),s=e.querySelector(".js-marketplace-plan-yearly-price-field").value;a.textContent=s,a.closest(".js-marketplace-plan-dollars-container").classList.remove("d-none")}"DIRECT_BILLING"===c&&(s.classList.add("d-none"),a.classList.add("d-none"),o.classList.remove("d-none"));const d=t.querySelector(".js-marketplace-plan-bullets");d.innerHTML="";const u=e.querySelectorAll(".js-marketplace-plan-bullet-field"),p=t.querySelector(".js-marketplace-plan-bullet-template");for(const k of u){const e=k.value;if(e.trim().length<1)continue;const t=p.content.cloneNode(!0);if(!(t instanceof DocumentFragment))return;t.querySelector(".js-marketplace-plan-bullet").textContent=e,d.appendChild(t)}const m=t.querySelector(".js-marketplace-plan-description"),g=e.querySelector(".js-marketplace-plan-description-field").value;m.textContent=g;const f=t.querySelector(".js-marketplace-plan-for-account-type"),j=(e.querySelector(".js-plan-for-account-type").textContent||"").toLowerCase();f.textContent=j}(r,a))})),n("click",".js-marketplace-plan-editor-toggle",(function(e){const t=e.currentTarget.closest(".js-marketplace-edit-plan-container"),n=t.querySelector(".js-marketplace-plan-preview-toggle"),r=t.querySelector(".js-marketplace-edit-plan-editor"),a=t.querySelector(".js-marketplace-edit-plan-preview");r.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),a.classList.add("d-none"),r.classList.remove("d-none"))})),n("change",".js-marketplace-plan-dollar-field",(function(e){const t=e.currentTarget;t.closest(".js-marketplace-plan-dollar-field-container").classList.toggle("is-errored",!t.checkValidity())})),a(".js-marketplace-order-quantity",(function(e){e.addEventListener("input",y)})),n("change","input.js-grant-oap-checkbox",(function(e){const t=e.currentTarget,n=document.querySelector(".js-marketplace-complete-order");n&&(n.disabled=!t.checked)})),n("click",".js-marketplace-complete-order",(function(e){e.preventDefault();const t=e.currentTarget,n=t.form,r=document.querySelector(".js-marketplace-billing-modal");"true"===t.getAttribute("data-show-billing-modal")&&r?r.setAttribute("open","true"):n&&n.submit()})),n("upload:setup",".js-upload-marketplace-listing-hero-card-background",(function(e){const{form:t}=e.detail,n=e.currentTarget.getAttribute("data-marketplace-listing-id");n&&t.append("marketplace_listing_id",n)})),n("upload:complete",".js-upload-marketplace-listing-hero-card-background",(function(e){const{attachment:t}=e.detail;document.querySelector(".js-marketplace-listing-hero-card-background-id").value=t.id,document.querySelector(".js-hero-listing-container").style.backgroundImage=`url(${t.href})`})),n("upload:setup",".js-upload-marketplace-listing-screenshot",(function(e){const{form:t}=e.detail,n=e.currentTarget.getAttribute("data-marketplace-listing-id");n&&t.append("marketplace_listing_id",n)})),n("upload:complete",".js-upload-marketplace-listing-screenshot",(async function(e){const t=e.currentTarget.getAttribute("data-screenshots-url"),n=document.querySelector(".js-marketplace-listing-screenshots-container"),r=await l(document,t);n.innerHTML="",n.appendChild(r)}))}}}));
//# sourceMappingURL=marketplace-e4447365.js.map
